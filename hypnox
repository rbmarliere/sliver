#!/usr/bin/env python3

from src import *
import argparse
import logging

logging.basicConfig(level=logging.INFO)

fmap = {
    "predict": model.predict,
    "predictb": model.predictb,
    "replay"  : db.replay,
    "replayb"  : db.replayb,
    "vader"  : db.vader,
    "stream" : stream.stream,
    "train"  : model.train,
    "trainb"  : model.trainb,
}

argp = argparse.ArgumentParser(
    prog="hypnox",
    usage="%(prog)s [options] command",
    description='''
          _        _
     |_| \_/ |_) |\ | / \ \/
     | |  |  |   | \| \_/ /\\

       sub noctem sapientia
    ''',
    formatter_class=argparse.RawTextHelpFormatter)
argp.add_argument("-i", "--input", help="tsv data file to use as input")
argp.add_argument("-m", "--model", help="name of model to use or save")
argp.add_argument("-p", "--polarity", help="use polarity model instead of intensity", action="store_true")
argp.add_argument("-t", "--table", help="name of the database table to replay into")
argp.add_argument("-u", "--update-only", help="replay only rows lacking", action="store_true")
argp.add_argument("command", choices=fmap.keys())
args = argp.parse_args()

func = fmap[args.command]
func(argp, args)

